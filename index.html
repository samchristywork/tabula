<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TODO</title>
    <style>
    </style>
  </head>
  <body>
    <script>
      const tables = [
        {
          name: "Test Table 1",
          position: {x: 10, y: 10},
          heading: ["Column 1", "Column 2", "Column 3"],
          content: [
            ["'foo'", "'bar'", "'baz'"],
            ["'apple'", "'banana'", "'carrot'"]
          ]
        },
      ];

      function createTableElement(table, tableIndex) {
        const container = document.createElement('div');
        container.className = 'table-container';
        container.style.left = table.position.x + 'px';
        container.style.top = table.position.y + 'px';

        const dragBar = document.createElement('div');
        dragBar.className = 'drag-bar';
        const titleText = document.createTextNode(table.name);
        dragBar.appendChild(titleText);

        container.appendChild(dragBar);

        const tableElement = document.createElement('table');

        const headerRow = document.createElement('tr');
        table.heading.forEach((headingText, headingIndex) => {
          const th = document.createElement('th');
          th.contentEditable = true;
          th.textContent = headingText;
          th.addEventListener('blur', () => {
            table.heading[headingIndex] = th.textContent;
          });
          headerRow.appendChild(th);
        });
        tableElement.appendChild(headerRow);

        table.content.forEach((rowData, rowIndex) => {
          const row = document.createElement('tr');
          rowData.forEach((cellData, cellIndex) => {
            const td = document.createElement('td');
            try {
              td.textContent = eval(cellData);
            } catch {
              td.textContent = 'Error';
            }

            row.appendChild(td);
          });
          tableElement.appendChild(row);
        });

        container.appendChild(tableElement);

        return container;
      }

      function render() {
        document.body.innerHTML = '';
        tables.forEach((table, index) => {
          const tableElement = createTableElement(table, index);
          document.body.appendChild(tableElement);
        });
      }

      render();
    </script>
  </body>
</html>
